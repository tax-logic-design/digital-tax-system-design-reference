---

**[file name]: 21_Audit_Log_Schema_Patterns.json**
```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Audit Log Schema Design Patterns - Educational Case Study",
  "description": "CONCEPTUAL EXAMPLE: Schema design patterns for immutable audit logging in system architecture studies. NOT FOR PRODUCTION USE.",
  
  "educationalPurpose": "Study schema design patterns for audit logging systems. Learn about immutability, traceability, and event sourcing concepts.",
  
  "criticalDisclaimer": {
    "warning": "EDUCATIONAL CASE STUDY ONLY",
    "note": "This is a design pattern example for studying audit log schemas. All log entries, transaction IDs, and jurisdictions are fictional placeholders.",
    "prohibited_uses": [
      "Not for actual audit logging",
      "Not for compliance systems",
      "Not for production use"
    ]
  },
  
  "conceptualSchemaPatterns": {
    "coreAuditLogEntry": {
      "type": "object",
      "description": "Core pattern for an immutable audit log entry.",
      "properties": {
        "log_id": {
          "type": "string",
          "description": "Unique identifier for the log entry - pattern for correlation IDs.",
          "pattern": "^LOG-[A-Z0-9]+-[0-9]{14}-[A-Z0-9]+$",
          "educationalNote": "Structured ID pattern enables traceability and partitioning."
        },
        "correlation_id": {
          "type": "string",
          "description": "ID linking related log entries across phases - pattern for transaction tracing.",
          "pattern": "^CORR-[A-Z0-9]+$"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp - critical for temporal ordering and audit trails.",
          "educationalNote": "Immutable timestamp; cannot be modified after creation."
        },
        "event_type": {
          "type": "string",
          "description": "Classification of the event - pattern for event categorization.",
          "examples": ["SYSTEM_STARTUP", "TRANSACTION_RECEIVED", "DECISION_MADE", "REVIEW_COMPLETED"]
        },
        "event_version": {
          "type": "string",
          "description": "Version of the event schema - enables schema evolution.",
          "example": "1.0"
        },
        "actor": {
          "type": "object",
          "description": "Entity that performed the action - system or human.",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["system", "human", "external_service"],
              "description": "Pattern for distinguishing automated vs. manual actions."
            },
            "id": {
              "type": "string",
              "description": "Identifier of the actor."
            },
            "role": {
              "type": "string",
              "description": "Functional role when actor is human.",
              "examples": ["REVIEWER", "ADMINISTRATOR", "AUDITOR"]
            }
          }
        },
        "phase": {
          "type": "string",
          "enum": ["PHASE_0_INGESTION", "PHASE_1_EVIDENCE", "PHASE_2_DECISION", "PHASE_3_REVIEW", "PHASE_4_AUDIT"],
          "description": "System phase where event occurred - pattern for phase tracing."
        },
        "jurisdiction_context": {
          "type": "string",
          "description": "Fictional jurisdiction context - pattern for scoping.",
          "examples": ["{{EXAMPLE_JURISDICTION_1}}", "{{EXAMPLE_JURISDICTION_2}}"]
        },
        "data_snapshot": {
          "type": "object",
          "description": "Immutable capture of relevant system state at event time.",
          "properties": {
            "input_hash": {
              "type": "string",
              "description": "Hash of input data - enables verification without storing PII."
            },
            "decision_hash": {
              "type": "string",
              "description": "Hash of decision data."
            }
          },
          "additionalProperties": true,
          "educationalNote": "Snapshot pattern captures state at event time, enabling reconstruction."
        },
        "metadata": {
          "type": "object",
          "description": "System metadata about the log entry itself.",
          "properties": {
            "environment": {
              "type": "string",
              "enum": ["production", "staging", "development", "educational"],
              "description": "Environment where event occurred."
            },
            "system_version": {
              "type": "string",
              "description": "Version of logging system."
            },
            "config_version": {
              "type": "string",
              "description": "Version of configuration at event time."
            }
          }
        },
        "integrity": {
          "type": "object",
          "description": "Integrity verification data - pattern for tamper evidence.",
          "properties": {
            "log_entry_hash": {
              "type": "string",
              "description": "Hash of the entire log entry for integrity verification."
            },
            "previous_log_hash": {
              "type": "string",
              "description": "Hash of previous log entry - pattern for blockchain-like chaining."
            },
            "signature": {
              "type": "string",
              "description": "Digital signature of the log entry."
            }
          }
        }
      },
      "required": ["log_id", "correlation_id", "timestamp", "event_type", "actor", "phase", "integrity"],
      "additionalProperties": false
    }
  },
  
  "educationalExamples": {
    "example_log_entry_phase1": {
      "log_id": "LOG-EDU-20250211101500-ABCD1234",
      "correlation_id": "CORR-TXN12345678",
      "timestamp": "2025-02-11T10:15:00Z",
      "event_type": "RESIDENCE_DETERMINATION",
      "event_version": "1.0",
      "actor": {"type": "system", "id": "engine_v2.1"},
      "phase": "PHASE_1_EVIDENCE",
      "jurisdiction_context": "{{EXAMPLE_JURISDICTION}}",
      "data_snapshot": {
        "input_hash": "7d865e959b2466918c9863afca942d0fb89d7c9ac0c99bafc3749504ded97730",
        "evidence_used": ["billing_address", "payment_card"],
        "confidence_score": 0.92,
        "requires_review": false,
        "note": "Example log entry for educational study of audit schemas."
      },
      "metadata": {
        "environment": "educational",
        "system_version": "2.1.0",
        "config_version": "2025.02.01"
      },
      "integrity": {
        "log_entry_hash": "a3f5c2d8e9b7a1c4f6d0e2b5c8a7d9f1e3c5b7a9d1f3e5c7a9b1d3f5e7c9a1b3d",
        "previous_log_hash": "b2e4d1c9f8a6b2d4e6c8a0d2f4e6c8a0b2d4f6e8a0c2e4d6f8a0b2d4e6c8a0d2f4",
        "signature": "{{EXAMPLE_SIGNATURE}}"
      }
    },
    "example_log_entry_phase3": {
      "log_id": "LOG-EDU-20250211102500-EFGH5678",
      "correlation_id": "CORR-TXN12345678",
      "timestamp": "2025-02-11T10:25:00Z",
      "event_type": "HUMAN_REVIEW_COMPLETED",
      "event_version": "1.0",
      "actor": {"type": "human", "id": "reviewer_001", "role": "SENIOR_REVIEWER"},
      "phase": "PHASE_3_REVIEW",
      "jurisdiction_context": "{{EXAMPLE_JURISDICTION}}",
      "data_snapshot": {
        "system_recommendation": {"decision": "approve", "confidence": 0.65},
        "human_decision": "adjust",
        "rationale_summary": "Evidence conflict resolved; billing address prioritized.",
        "adjustments_made": {"jurisdiction": "{{EXAMPLE_JURISDICTION_ADJUSTED}}"},
        "review_duration_seconds": 245
      },
      "metadata": {
        "environment": "educational",
        "system_version": "2.1.0",
        "config_version": "2025.02.01"
      },
      "integrity": {
        "log_entry_hash": "e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7c6",
        "previous_log_hash": "a3f5c2d8e9b7a1c4f6d0e2b5c8a7d9f1e3c5b7a9d1f3e5c7a9b1d3f5e7c9a1b3d",
        "signature": "{{EXAMPLE_SIGNATURE}}"
      }
    }
  },
  
  "studyExercises": {
    "beginner": [
      "Identify all fields that contribute to making this log entry 'immutable'.",
      "Explain the purpose of the 'correlation_id' field across multiple log entries.",
      "What is the significance of including 'previous_log_hash' in each entry?"
    ],
    "intermediate": [
      "Design an extension to this schema that would support 'redaction' of sensitive fields for auditor access, while maintaining immutability of the original log.",
      "Create a query pattern to reconstruct the full audit trail for a given correlation_id.",
      "Design a log rotation and archival strategy that maintains the integrity chain."
    ],
    "advanced": [
      "Design a distributed audit logging system using this schema that can handle 10,000 events per second while maintaining the integrity chain.",
      "Propose a mechanism for third-party auditors to verify log integrity without granting them database access.",
      "Design a schema evolution strategy that allows adding new fields without breaking existing log readers."
    ]
  },
  
  "relatedConcepts": {
    "auditPatterns": ["Event Sourcing", "Command Query Responsibility Segregation", "Immutable Logs", "Blockchain"],
    "integrityPatterns": ["Merkle Trees", "Digital Signatures", "Hash Chains"],
    "schemaDesign": ["Versioning", "Backward Compatibility", "Extensibility"]
  },
  
  "metadata": {
    "schemaVersion": "1.0.0",
    "educationalPurpose": "System architecture and audit log schema design study",
    "createdFor": "Academic research and coursework",
    "lastUpdated": "{{CURRENT_DATE}}",
    "license": "Educational Use Only"
  }
}